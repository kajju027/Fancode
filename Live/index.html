<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Full Customized Live Player</title>

    <meta name="referrer" content="no-referrer" />
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />

    <style>
        html, body {
            height: 100%;
            margin: 0;
            background: #000;
            overflow: hidden;
        }

        .video-container {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .plyr {
            width: 100%;
            height: 100%;
        }

        :root {
            --plyr-color-main: #00adee;
        }
    </style>
</head>
<body>

    <div class="video-container">
        <video id="player" playsinline controls></video>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>

    <script>

        function getVideo() {
            const p = new URLSearchParams(window.location.search);
            return p.get("ios") ? decodeURIComponent(p.get("ios")) : null;
        }

        function initPlayer() {

            const videoURL = getVideo();
            const video = document.getElementById("player");

            if (!videoURL) {
                alert("Missing video URL. Use ?ios=YOUR_LINK");
                return;
            }

            const player = new Plyr(video, {
                controls: [
                    'play-large',
                    'restart',
                    'rewind',
                    'play',
                    'fast-forward',
                    'progress',
                    'current-time',
                    'duration',
                    'mute',
                    'volume',
                    'captions',
                    'settings',
                    'pip',
                    'airplay',
                    'download',
                    'fullscreen'
                ],

                settings: [
                    'captions',
                    'quality',
                    'speed',
                    'loop'
                ],

                speed: { selected: 1, options: [0.25,0.5,0.75,1,1.25,1.5,2] },
                tooltips: { controls: true, seek: true },
                clickToPlay: true
            });

            if (Hls.isSupported() && videoURL.includes(".m3u8")) {

                const hls = new Hls({ maxMaxBufferLength: 60 });
                hls.loadSource(videoURL);
                hls.attachMedia(video);

                hls.on(Hls.Events.MANIFEST_PARSED, (e, data) => {

                    const qualities = data.levels.map(l => l.height)
                        .filter((v, i, a) => a.indexOf(v) === i)
                        .sort((a, b) => b - a);

                    player.options.quality = {
                        default: qualities[0],
                        options: qualities,
                        forced: true,
                        onChange: q => {
                            const idx = data.levels.findIndex(x => x.height === q);
                            hls.currentLevel = idx;
                        }
                    };

                    player.quality = qualities[0];
                });

            } else {
                video.src = videoURL;
            }
        }

        document.addEventListener("DOMContentLoaded", initPlayer);
    </script>

</body>
</html>
