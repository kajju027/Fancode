<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CRICKET NEWS POINT -13</title>

  <!-- Plyr CSS -->
  <link rel="stylesheet" href="https://cdn.plyr.io/4.1.11/plyr.css" />

  <style>
    :root{
      --bg:#0a0a0a; --panel:#111; --muted:#bdbdbd;
      --accent-start:#00a4ff; --accent-end:#7a5cff; --white:#eaeaea;
      --black:#000;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--white);font-family:Inter,system-ui,Arial,Helvetica,sans-serif}
    header{position:fixed;top:0;left:0;right:0;height:70px;display:flex;align-items:center;justify-content:center;background:rgba(10,10,10,0.95);border-bottom:1px solid rgba(255,255,255,0.04);z-index:20;padding:0 12px}
    header img{height:85%}
    .menu-icon{cursor:pointer;font-size:28px;position:absolute;left:12px}
    .main-wrapper{margin-top:70px;padding-bottom:24px}
    .player-wrap{max-width:1080px;margin:14px auto;padding:12px;box-sizing:border-box}
    /* Video box with responsive aspect */
    .video-card{background:#000;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
    .video-area{width:100%;--ar:16/9;aspect-ratio:var(--ar);background:#000;display:flex;align-items:center;justify-content:center}
    /* Controls area under player for URL and info */
    .player-info{display:flex;gap:8px;align-items:center;justify-content:space-between;padding:10px 14px;background:linear-gradient(180deg,rgba(18,18,18,0.6),rgba(12,12,12,0.6));font-size:13px;color:var(--muted)}
    .player-info .small{color:var(--muted);font-size:13px}
    .player-placeholder{padding:22px;text-align:center;color:var(--muted);font-size:15px}
    /* Sidebar */
    .sidebar{position:fixed;top:0;left:-260px;width:240px;height:100%;background:#0f0f0f;padding-top:70px;transition:left .28s ease;z-index:18;border-right:1px solid rgba(255,255,255,0.03)}
    .sidebar.open{left:0}
    .sidebar a{display:block;padding:12px 18px;color:#fff;text-decoration:none;border-bottom:1px solid rgba(255,255,255,0.03);font-size:15px}
    .menu-header{font-size:18px;font-weight:700;text-align:center;padding:12px 0;color:#fff}
    .overlay{position:fixed;top:0;left:0;width:100%;height:100%;z-index:17;display:none}
    .overlay.show{display:block}
    .visitor-box{display:none;padding:12px;text-align:center;border-top:1px solid rgba(255,255,255,0.04)}
    .visitor-box img{width:120px}
    /* Popup (kept from original) */
    .popup-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:1000;background:rgba(0,0,0,0.85);overflow:hidden}
    .popup-box{position:relative;z-index:2;width:min(520px,94%);background:linear-gradient(180deg,rgba(30,30,30,0.98),rgba(22,22,22,0.98));border-radius:14px;padding:28px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.7);border:1px solid rgba(255,255,255,0.03);transform-origin:center}
    .popup-header{font-size:22px;font-weight:800;margin:0 0 8px;color:#fff}
    .popup-subtitle{margin:0 0 18px;color:var(--muted);font-size:15px}
    .popup-actions{display:flex;gap:12px;justify-content:center;margin-top:6px}
    .popup-btn{flex:0 0 48%;padding:12px 14px;border-radius:8px;border:0;font-size:15px;font-weight:700;cursor:pointer;color:#fff;display:inline-flex;align-items:center;justify-content:center;text-decoration:none}
    .already-btn{background:var(--black);border:1px solid rgba(255,255,255,0.03)}
    .join-btn{background:linear-gradient(90deg,var(--accent-start),var(--accent-end))}
    body.no-scroll{overflow:hidden}
    @media(max-width:640px){
      .player-info{flex-direction:column;align-items:flex-start;gap:6px;font-size:12px}
      .video-card{border-radius:8px}
    }
  </style>
</head>
<body>
  <!-- Popup overlay (same behavior as your file) -->
  <div class="popup-overlay" id="popupOverlay" aria-hidden="true" role="dialog" style="display:none">
    <div class="popup-box" role="document" aria-labelledby="popupTitle" aria-describedby="popupDesc">
      <div class="popup-header" id="popupTitle">Support Us</div>
      <div class="popup-subtitle" id="popupDesc">Join our WhatsApp Channel to support the stream</div>
      <div class="popup-actions" role="group" aria-label="popup actions">
        <button class="popup-btn already-btn" id="alreadyBtn" aria-pressed="false">Already Joined</button>
        <a id="joinLink" class="popup-btn join-btn" href="https://whatsapp.com/channel/0029VaeylYYBPzjVNomWuZ0T" target="_blank" rel="noopener noreferrer">Join Now</a>
      </div>
    </div>
  </div>

  <header>
    <span class="material-icons menu-icon" onclick="toggleSidebar()">menu</span>
    <img src="https://files.catbox.moe/g2tdt0.jpeg" alt="Logo">
  </header>

  <div id="mainContent" class="main-wrapper" aria-hidden="false">
    <div class="player-wrap">
      <div class="video-card" role="region" aria-label="Video player">
        <div class="video-area" id="videoArea">
          <!-- Plyr video element. Source will be attached by JS. -->
          <video id="player" playsinline controls crossorigin>
            <!-- fallback text -->
            Your browser does not support HTML5 video.
          </video>
        </div>

        <div class="player-info">
          <div class="small" id="srcLabel">No stream loaded. Use ?ios=YOUR_M3U8_URL</div>
          <div style="display:flex;gap:8px;align-items:center">
            <button id="reloadBtn" style="padding:8px 10px;border-radius:8px;border:0;background:linear-gradient(90deg,var(--accent-start),var(--accent-end));color:#fff;font-weight:700;cursor:pointer">Reload</button>
            <a id="openInNew" target="_blank" rel="noopener" style="padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);text-decoration:none;font-weight:700">Open stream</a>
          </div>
        </div>

        <div class="player-placeholder" id="hint">
          Provide an HLS link in the URL like <code>?ios=https://example.com/stream.m3u8</code>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar" aria-hidden="true">
      <div class="menu-header">MENU</div>
      <a href="https://whatsapp.com/channel/0029VaeylYYBPzjVNomWuZ0T" target="_blank">Join WhatsApp</a>
      <a href="https://www.instagram.com/sonu__7xyz?" target="_blank">Contact Us</a>
      <a href="https://sayan-mete.onrender.com/copyright" target="_blank">Copyright</a>
      <a href="javascript:void(0)" onclick="toggleVisitor()">Visitor Count</a>
      <div class="visitor-box" id="visitorBox">
        <img src="https://www.counter12.com/img-9205Yd3W54Z3y43Z-5.gif" alt="Visitor Count" />
      </div>
    </div>

    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
  </div>

  <!-- Plyr JS and HLS -->
  <script src="https://cdn.plyr.io/4.1.11/plyr.polyfilled.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.1/dist/hls.min.js"></script>

  <script>
    /* Minimal utilities */
    function qs(sel, root=document){return root.querySelector(sel)}
    function getParam(name){
      const u = new URL(location.href);
      return u.searchParams.get(name);
    }

    /* Sidebar / visitor UI */
    function toggleSidebar(){
      document.getElementById('sidebar').classList.toggle('open');
      document.getElementById('overlay').classList.toggle('show');
    }
    function toggleVisitor(){
      const vb = document.getElementById('visitorBox');
      vb.style.display = (vb.style.display === 'block') ? 'none' : 'block';
    }

    /* Popup behavior */
    document.addEventListener('DOMContentLoaded', function(){
      const popup = document.getElementById('popupOverlay');
      const alreadyBtn = document.getElementById('alreadyBtn');
      const joinLink = document.getElementById('joinLink');
      const mainContent = document.getElementById('mainContent');

      function showPopup(){ popup.style.display='flex'; popup.setAttribute('aria-hidden','false'); document.documentElement.classList.add('no-scroll'); document.body.classList.add('no-scroll'); if(mainContent) mainContent.setAttribute('aria-hidden','true'); }
      function closePopup(){ popup.style.display='none'; popup.setAttribute('aria-hidden','true'); document.documentElement.classList.remove('no-scroll'); document.body.classList.remove('no-scroll'); if(mainContent) mainContent.setAttribute('aria-hidden','false'); }

      showPopup(); // always show on load as requested

      alreadyBtn.addEventListener('click', closePopup);
      joinLink.addEventListener('click', function(){
        // subtle tap animation
        joinLink.animate([{transform:'translateY(0)'},{transform:'translateY(-3px)'},{transform:'translateY(0)'}],{duration:160});
      });

      // prevent Escape closing or scrolling
      window.addEventListener('keydown', function(e){ if(e.key==='Escape') e.preventDefault(); });
    });

    /* Player setup */
    (function(){
      const urlParam = getParam('ios');
      const playerEl = qs('#player');
      const srcLabel = qs('#srcLabel');
      const hint = qs('#hint');
      const openInNew = qs('#openInNew');
      const reloadBtn = qs('#reloadBtn');

      // initialize Plyr instance (controls and settings)
      const plyr = new Plyr(playerEl, {
        controls: ['play', 'progress', 'current-time', 'mute', 'volume', 'settings', 'fullscreen'],
        clickToPlay: true,
        keyboard: { focused: true, global: false },
        ratio: '16:9'
      });

      function setSourceAndPlay(hlsUrl){
        hint.style.display = 'none';
        srcLabel.textContent = 'Stream: ' + hlsUrl;
        openInNew.href = hlsUrl;
        openInNew.textContent = 'Open stream';

        // Clean previous source
        try{ plyr.stop(); }catch(e){}
        // Use native HLS on Safari / iOS, else use hls.js
        const isNativeHls = playerEl.canPlayType('application/vnd.apple.mpegurl');
        if (isNativeHls) {
          playerEl.src = hlsUrl;
          // attempt autoplay (many mobile browsers block autoplay)
          playerEl.setAttribute('playsinline','');
          playerEl.play().catch(()=>{});
        } else if (window.Hls && Hls.isSupported()) {
          // destroy any existing hls instance attached to the element
          if (playerEl._hls) { try{ playerEl._hls.destroy(); }catch(e){} playerEl._hls = null; }
          const hls = new Hls({liveSyncDurationCount:3});
          playerEl._hls = hls;
          hls.loadSource(hlsUrl);
          hls.attachMedia(playerEl);
          hls.on(Hls.Events.MANIFEST_PARSED, function(){ playerEl.play().catch(()=>{}); });
          hls.on(Hls.Events.ERROR, function(event, data){
            console.warn('Hls error', data);
            // show hint for user
            srcLabel.textContent = 'Stream load error. Check the link or CORS.';
          });
        } else {
          srcLabel.textContent = 'HLS not supported in this browser.';
        }
      }

      if (urlParam && urlParam.trim()){
        // attempt to decode if needed (user may URL-encode)
        let streamUrl = urlParam.trim();
        try{ streamUrl = decodeURIComponent(streamUrl); }catch(e){}
        setSourceAndPlay(streamUrl);
      } else {
        // no stream provided. show placeholder
        hint.style.display = 'block';
        srcLabel.textContent = 'No stream loaded';
        openInNew.removeAttribute('href');
        openInNew.textContent = 'Open stream';
      }

      // reload button re-reads param and reloads player
      reloadBtn.addEventListener('click', function(){
        const p = getParam('ios');
        if (p) {
          try{ setSourceAndPlay(decodeURIComponent(p)); }catch(e){ setSourceAndPlay(p); }
        } else {
          hint.style.display = 'block';
          srcLabel.textContent = 'No stream loaded';
        }
      });

      // expose for debugging if needed
      window.__plyr = plyr;
    })();
  </script>
</body>
          </html>
